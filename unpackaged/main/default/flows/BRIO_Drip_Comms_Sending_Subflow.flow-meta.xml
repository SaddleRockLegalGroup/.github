<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Send_Email_NOT_orgwide_email</name>
        <label>Send Email to Contact</label>
        <locationX>930</locationX>
        <locationY>3278</locationY>
        <actionName>SendEmail</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Is_an_SMS_being_sent_for_this_Outbound_Comm</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Copy_2_of_Create_Error_Log</targetReference>
        </faultConnector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>bccAddresses</name>
            <value>
                <elementReference>Loop_Outbound_Comm_Records.BCC__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ccAddresses</name>
            <value>
                <elementReference>Loop_Outbound_Comm_Records.CC__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ContactOrLeadID</name>
            <value>
                <elementReference>var_rec_RecipientContact.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>EmailTemplateId</name>
            <value>
                <elementReference>Get_Email_Template.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>RelatedToId</name>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>SaveAsActivity</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <nameSegment>SendEmail</nameSegment>
    </actionCalls>
    <actionCalls>
        <name>Send_Email_to_Contact</name>
        <label>Send Email to Contact</label>
        <locationX>402</locationX>
        <locationY>3278</locationY>
        <actionName>SendEmail</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Is_an_SMS_being_sent_for_this_Outbound_Comm</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Create_Error_Log</targetReference>
        </faultConnector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>bccAddresses</name>
            <value>
                <elementReference>Loop_Outbound_Comm_Records.BCC__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ccAddresses</name>
            <value>
                <elementReference>Loop_Outbound_Comm_Records.CC__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ContactOrLeadID</name>
            <value>
                <elementReference>var_rec_RecipientContact.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>EmailTemplateId</name>
            <value>
                <elementReference>Get_Email_Template.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>OrgWideEmailAddress</name>
            <value>
                <elementReference>Loop_Outbound_Comm_Records.Email_From__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>RelatedToId</name>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>SaveAsActivity</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <nameSegment>SendEmail</nameSegment>
    </actionCalls>
    <actionCalls>
        <name>Send_Email_to_User_No_OrgWide_Email</name>
        <label>Send Email to User</label>
        <locationX>3042</locationX>
        <locationY>2438</locationY>
        <actionName>SendEmail</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Is_an_SMS_being_sent_for_this_Outbound_Comm</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Copy_4_of_Create_Error_Log</targetReference>
        </faultConnector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>bccAddresses</name>
            <value>
                <elementReference>Loop_Outbound_Comm_Records.BCC__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ccAddresses</name>
            <value>
                <elementReference>Loop_Outbound_Comm_Records.CC__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ContactOrLeadID</name>
            <value>
                <elementReference>Get_Intake.Owner:User.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>EmailTemplateId</name>
            <value>
                <elementReference>Loop_Outbound_Comm_Records.Email_Template_ID__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>RelatedToId</name>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>SaveAsActivity</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <nameSegment>SendEmail</nameSegment>
    </actionCalls>
    <actionCalls>
        <name>Send_Intake_Team_Email</name>
        <label>Send Intake Team Email</label>
        <locationX>4362</locationX>
        <locationY>2438</locationY>
        <actionName>SendEmail</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Is_an_SMS_being_sent_for_this_Outbound_Comm</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Log_Error_intake_team_Email</targetReference>
        </faultConnector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>ContactOrLeadID</name>
            <value>
                <elementReference>$Setup.SRLG_Automated_Comms_Settings__c.Intake_Team_Contact_Id__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>EmailTemplateId</name>
            <value>
                <elementReference>Loop_Outbound_Comm_Records.Email_Template_ID__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>RelatedToId</name>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>SaveAsActivity</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <nameSegment>SendEmail</nameSegment>
    </actionCalls>
    <actionCalls>
        <name>Send_SMS</name>
        <label>Send SMS</label>
        <locationX>3960</locationX>
        <locationY>4586</locationY>
        <actionName>TwilioSF__TwilioSendSMS</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Create_SMS_Activity</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Copy_5_of_Create_Error_Log</targetReference>
        </faultConnector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>message</name>
            <value>
                <elementReference>SMS_message_with_substitutions</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>recordId</name>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>toNumber</name>
            <value>
                <elementReference>Get_Intake.Mobile_twilio__c</elementReference>
            </value>
        </inputParameters>
        <nameSegment>TwilioSF__TwilioSendSMS</nameSegment>
    </actionCalls>
    <actionCalls>
        <name>Send_Vendor_Email</name>
        <label>Send Vendor Email</label>
        <locationX>3834</locationX>
        <locationY>2546</locationY>
        <actionName>SendEmail</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Is_an_SMS_being_sent_for_this_Outbound_Comm</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Log_Error_Vendor_Email</targetReference>
        </faultConnector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>bccAddresses</name>
            <value>
                <elementReference>Get_Intake.Intake_Vendor__r.X3P_Email_BCC__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ccAddresses</name>
            <value>
                <elementReference>formula_vendorCommCC</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ContactOrLeadID</name>
            <value>
                <elementReference>Get_Intake.Intake_Vendor__r.X3P_Email_To_Contact__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>EmailTemplateId</name>
            <value>
                <elementReference>Loop_Outbound_Comm_Records.Email_Template_ID__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>OrgWideEmailAddress</name>
            <value>
                <elementReference>Get_Intake.Intake_Vendor__r.X3P_From_Email__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>RelatedToId</name>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>SaveAsActivity</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <nameSegment>SendEmail</nameSegment>
    </actionCalls>
    <apiVersion>60.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <assignments>
        <description>Add record to input collection and then process as if the input collection was passed in</description>
        <name>Add_Single_Record_to_Collection</name>
        <label>Add Single Record to Collection</label>
        <locationX>182</locationX>
        <locationY>974</locationY>
        <assignmentItems>
            <assignToReference>input_col_CommRecords</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Get_Outbound_Communication_record</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Filter_Outbound_Comm_List</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Caller_to_Contac_Var</name>
        <label>Assign Caller to Contac Var</label>
        <locationX>1854</locationX>
        <locationY>2654</locationY>
        <assignmentItems>
            <assignToReference>var_rec_RecipientContact</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Caller_Contact</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Can_we_send_to_this_Contact</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_GET_Contact_to_variable0</name>
        <label>Assign GET Contact to variable</label>
        <locationX>1590</locationX>
        <locationY>2654</locationY>
        <assignmentItems>
            <assignToReference>var_rec_RecipientContact</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Client_Contact</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Can_we_send_to_this_Contact</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Collection_to_Process_for_Sending_Enabled</name>
        <label>Set Collection to Process for Sending Enabled</label>
        <locationX>314</locationX>
        <locationY>1382</locationY>
        <assignmentItems>
            <assignToReference>var_col_commRecordsToSend</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Filter_OC_Collection_Active</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Outbound_Comm_Records</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Collection_to_Process_for_Test_User</name>
        <label>Set Collection to Process for Test User</label>
        <locationX>50</locationX>
        <locationY>1382</locationY>
        <assignmentItems>
            <assignToReference>var_col_commRecordsToSend</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Filter_OC_Collection_Active_or_Active_for_Testing</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Outbound_Comm_Records</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_SMS_Template</name>
        <label>Set SMS Template</label>
        <locationX>4488</locationX>
        <locationY>4262</locationY>
        <assignmentItems>
            <assignToReference>var_SMS</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>SMS_message_with_substitutions</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_Phone_Time_Zone</targetReference>
        </connector>
    </assignments>
    <collectionProcessors>
        <name>Filter_OC_Collection_Active</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Filter OC Collection - Active</label>
        <locationX>314</locationX>
        <locationY>1274</locationY>
        <assignNextValueToReference>currentItem_Copy_1_of_Collection_Filter_1</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>input_col_CommRecords</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Copy_1_of_Collection_Filter_1.Active__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <booleanValue>true</booleanValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Set_Collection_to_Process_for_Sending_Enabled</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>Filter_OC_Collection_Active_or_Active_for_Testing</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>Filter OC Collection - Active or Active for Testing</label>
        <locationX>50</locationX>
        <locationY>1274</locationY>
        <assignNextValueToReference>currentItem_Filter_OC_Collection_Active_or_Active_for_Testing</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>input_col_CommRecords</collectionReference>
        <conditionLogic>or</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_Filter_OC_Collection_Active_or_Active_for_Testing.Active__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <booleanValue>true</booleanValue>
            </rightValue>
        </conditions>
        <conditions>
            <leftValueReference>currentItem_Filter_OC_Collection_Active_or_Active_for_Testing.Active_For_Testing__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <booleanValue>true</booleanValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>Set_Collection_to_Process_for_Test_User</targetReference>
        </connector>
    </collectionProcessors>
    <constants>
        <name>const_FlowName</name>
        <dataType>String</dataType>
        <value>
            <stringValue>BRIO_Drip_Comms_Sending_Subflow</stringValue>
        </value>
    </constants>
    <decisions>
        <name>Can_we_send_to_this_Contact</name>
        <label>Can we send to this Contact?</label>
        <locationX>1854</locationX>
        <locationY>2846</locationY>
        <defaultConnector>
            <targetReference>Log_Error_Unhandled_Path_Can_we_send</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_we_can_send</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>var_rec_RecipientContact.Email</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>var_rec_RecipientContact.HasOptedOutOfEmail</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>var_rec_RecipientContact.IsEmailBounced</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Intake.Do_Not_Email_Intake__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Log4</targetReference>
            </connector>
            <label>Yes, we can send</label>
        </rules>
        <rules>
            <name>No_email_is_bounced</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>var_rec_RecipientContact.IsEmailBounced</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Log5</targetReference>
            </connector>
            <label>No, email is bounced</label>
        </rules>
        <rules>
            <name>No_Intake_requested_Do_Not_Email</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Intake.Do_Not_Email_Intake__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Log_Debug_Intake_Do_Not_Email</targetReference>
            </connector>
            <label>No, Intake requested Do Not Email</label>
        </rules>
        <rules>
            <name>No_Contact_has_opted_out</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>var_rec_RecipientContact.HasOptedOutOfEmail</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Log6</targetReference>
            </connector>
            <label>No, Contact has opted out</label>
        </rules>
        <rules>
            <name>Contact_is_null</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>var_rec_RecipientContact</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Log_Debug_Contact_is_Null_Not_Sending</targetReference>
            </connector>
            <label>Contact is null</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_if_we_can_send_SMS</name>
        <label>Check if we can send SMS</label>
        <locationX>4488</locationX>
        <locationY>4478</locationY>
        <defaultConnector>
            <targetReference>Loop_Outbound_Comm_Records</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Sending</defaultConnectorLabel>
        <rules>
            <name>Can_we_Send_Text</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Check_Phone_Time_Zone.output_bool_okToCall</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Intake.Do_Not_Text_Intake__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_SMS</targetReference>
            </connector>
            <label>Can we Send Text</label>
        </rules>
        <rules>
            <name>No_Intake_Do_Not_SMS</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Intake.Do_Not_Text_Intake__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Debug_Intake_Do_Not_Text</targetReference>
            </connector>
            <label>No, Intake Do Not SMS</label>
        </rules>
        <rules>
            <name>Can_t_Text_Right_Now</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Check_Phone_Time_Zone.output_bool_okToCall</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Debug_TCPA_Can_t_Text_Now</targetReference>
            </connector>
            <label>Can&#39;t Text Right Now</label>
        </rules>
    </decisions>
    <decisions>
        <name>Decision_Client_or_Caller_Recipient</name>
        <label>Client or Caller Recipient</label>
        <locationX>1854</locationX>
        <locationY>2438</locationY>
        <defaultConnector>
            <targetReference>Log_Error_Path_Not_Handled</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Something is Wrong</defaultConnectorLabel>
        <rules>
            <name>outcome_Recipient_is_Client</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Loop_Outbound_Comm_Records.Recipient__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Client</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Client_Contact</targetReference>
            </connector>
            <label>Recipient is Client</label>
        </rules>
        <rules>
            <name>Recipient_is_Caller</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Loop_Outbound_Comm_Records.Recipient__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Caller</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Caller_Contact</targetReference>
            </connector>
            <label>Recipient is Caller</label>
        </rules>
    </decisions>
    <decisions>
        <name>Did_we_get_an_input_comm_ID</name>
        <label>Did we get an input comm ID</label>
        <locationX>314</locationX>
        <locationY>758</locationY>
        <defaultConnector>
            <targetReference>Filter_Outbound_Comm_List</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No ID Passed in....carry on</defaultConnectorLabel>
        <rules>
            <name>Yes_got_an_input_ID</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>input_OutboundCommsID</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>var_col_commRecordsToSend</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Outbound_Communication_record</targetReference>
            </connector>
            <label>Yes...got an input ID</label>
        </rules>
    </decisions>
    <decisions>
        <description>Filter input collection as extra check if we should send</description>
        <name>Filter_Outbound_Comm_List</name>
        <label>Filter Outbound Comm List</label>
        <locationX>314</locationX>
        <locationY>1166</locationY>
        <defaultConnector>
            <targetReference>Log_Debug_Filter_Decision_Sending_Disabled</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Testing_User</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Permission.BRIO_Automated_Comms_Tester</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Intake.litify_pm__Display_Name__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Test</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Filter_OC_Collection_Active_or_Active_for_Testing</targetReference>
            </connector>
            <label>Filter for Testing User</label>
        </rules>
        <rules>
            <name>Filter_for_Sending_Enabled</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.SRLG_Automated_Comms_Settings__c.Sending_Enabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Filter_OC_Collection_Active</targetReference>
            </connector>
            <label>Filter for Sending Enabled</label>
        </rules>
    </decisions>
    <decisions>
        <description>If the Email Template field on the Outbound Comm is not null, then an email should be sent.</description>
        <name>Is_an_email_being_sent_for_this_Outbound_Comm</name>
        <label>Is an email being sent for this Outbound Comm?</label>
        <locationX>4840</locationX>
        <locationY>1682</locationY>
        <defaultConnector>
            <targetReference>Log_No_Email_Template_Set</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Email Template ID Null</defaultConnectorLabel>
        <rules>
            <name>Yes_send_email</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Loop_Outbound_Comm_Records.Email_Template_ID__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Log_Email_Template_ID_Populated</targetReference>
            </connector>
            <label>Yes, send email</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_an_SMS_being_sent_for_this_Outbound_Comm</name>
        <label>Is an SMS being sent for this Outbound Comm?</label>
        <locationX>4840</locationX>
        <locationY>4046</locationY>
        <defaultConnector>
            <targetReference>Create_Log77</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_send_SMS</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Loop_Outbound_Comm_Records.SMS_Message_to_Client__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Log88</targetReference>
            </connector>
            <label>Yes, send SMS</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Vendor_Comm_Disabled</name>
        <label>Is Vendor Comm Disabled</label>
        <locationX>3702</locationX>
        <locationY>2438</locationY>
        <defaultConnector>
            <targetReference>Send_Vendor_Email</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Comms_Disabled</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Intake.Intake_Vendor__r.Disable_Vendor_Communication__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Log_Debug_Vendor_Comm_Disabled</targetReference>
            </connector>
            <label>Comms Disabled</label>
        </rules>
    </decisions>
    <decisions>
        <name>Sending_Enabled_or_Test_User</name>
        <label>Sending Enabled or Test User</label>
        <locationX>314</locationX>
        <locationY>350</locationY>
        <defaultConnector>
            <targetReference>Log_Debug_Sending_Disabled</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Sending_Enabled</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Setup.SRLG_Automated_Comms_Settings__c.Sending_Enabled__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Did_we_get_an_input_comm_ID</targetReference>
            </connector>
            <label>Sending Enabled</label>
        </rules>
        <rules>
            <name>Test_User</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Permission.BRIO_Automated_Comms_Tester</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Intake.litify_pm__Display_Name__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Test</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Log_Debug_Testing_User</targetReference>
            </connector>
            <label>Test User</label>
        </rules>
    </decisions>
    <decisions>
        <description>The &quot;SendEmail&quot; Apex action needs to be configured differently based on the From and Recipient listed on the Outbound Comms.</description>
        <name>Sending_Specs</name>
        <label>Sending Specs</label>
        <locationX>3372</locationX>
        <locationY>2222</locationY>
        <defaultConnector>
            <targetReference>Log_No_Sending_Path_Configured</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Client_or_Caller</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>Loop_Outbound_Comm_Records.Recipient__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Caller</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Loop_Outbound_Comm_Records.Recipient__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Client</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Log_Recipient_is_Client_or_Caller</targetReference>
            </connector>
            <label>Client or Caller</label>
        </rules>
        <rules>
            <name>Recipient_is_Lead_Owner_and_From_is_NOT_populated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Loop_Outbound_Comm_Records.Email_From__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Loop_Outbound_Comm_Records.Recipient__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Lead Owner</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Log_Debug_Recipient_is_Lead_Owner</targetReference>
            </connector>
            <label>Recipient is Lead Owner and &#39;From&#39; is NOT populated</label>
        </rules>
        <rules>
            <name>Recipient_is_Vendor</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Loop_Outbound_Comm_Records.Recipient__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Vendor</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Log_Debug_Recipient_is_Vendor</targetReference>
            </connector>
            <label>Recipient is Vendor</label>
        </rules>
        <rules>
            <name>outcome_Intake_Team_Recipient</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Loop_Outbound_Comm_Records.Recipient__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Intake Team</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Log_Recipient_is_Intake_Team</targetReference>
            </connector>
            <label>Intake Team Recipient</label>
        </rules>
    </decisions>
    <decisions>
        <name>Template_found</name>
        <label>Template found?</label>
        <locationX>4263</locationX>
        <locationY>2006</locationY>
        <defaultConnector>
            <targetReference>Log_Error_Template_ID_Not_Found</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_template_found</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Email_Template</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Log_Template_Confirmed</targetReference>
            </connector>
            <label>Yes, template found</label>
        </rules>
    </decisions>
    <decisions>
        <description>We have already determined this in an earlier Decision, so I will just reference that Decision here. When the &#39;From&#39; field on Outbound Comms has a value, it is being sent from an Org Wide Email.</description>
        <name>Who_is_this_email_from</name>
        <label>Who is this email from?</label>
        <locationX>930</locationX>
        <locationY>3062</locationY>
        <defaultConnector>
            <targetReference>Log_Error_Path_Not_Handled1</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Org_Wide_Email</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Loop_Outbound_Comm_Records.Email_From__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Log_Debug_Org_wide_email_send</targetReference>
            </connector>
            <label>Org-Wide Email</label>
        </rules>
        <rules>
            <name>Email_is_from_Running_User</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Client_or_Caller</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Log_Debug_Email_from_Running_User</targetReference>
            </connector>
            <label>Email is from Running User</label>
        </rules>
    </decisions>
    <description>Called when an Outbound Comms record has criteria matching the Intake.
DR - 6/2 - Moving Sending Enabled Logic and Loop Logic Here
DR - 6/20 - Adding check for disabling vendor comms and additional vendor CC
DR - 6/24 - Changing SMS phone to Mobile_twilio__c
DR - 7/17 - Adjusting additional CC formula to account for null
MR - 8/7 - Updated Decisions to support Do Not Email &amp; Do Not Text fields from the Intake
MC - 8/13 - Updating DNE and DNT and DNC items - Adding SMS task with it.
DR - 8/21 - Changes lost in flow versioning for SMS substitution tokens.  Re-applying change - 2 tokens to SMS template (&lt;&lt;Caller First Name&gt;&gt; and &lt;&lt;Client First Name&gt;&gt;)
DR - 8/31/24 - Updated time zone check to use twilio mobile field
DR - 9/3/24 - Adding logging for time zone sms check</description>
    <environments>Default</environments>
    <formulas>
        <name>formula_vendorCommCC</name>
        <dataType>String</dataType>
        <expression>SUBSTITUTE(SUBSTITUTE({!Get_Intake.Intake_Vendor__r.X3P_Email_CC__c} &amp; IF(NOT(ISBLANK({!Get_Intake.Intake_Vendor__r.X3P_Email_CC__c} )) &amp;&amp; NOT(ISBLANK( {!Loop_Outbound_Comm_Records.CC__c})), &quot;,&quot;, &quot;&quot;) &amp;  {!Loop_Outbound_Comm_Records.CC__c}, &quot; &quot;, &quot;&quot;), &quot;,,&quot;, &quot;,&quot;)</expression>
    </formulas>
    <formulas>
        <description>This is the SMS message taking into account our merge field workarounds (using the SUBSTITUTE function).</description>
        <name>SMS_message_with_substitutions</name>
        <dataType>String</dataType>
        <expression>SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE({!Loop_Outbound_Comm_Records.SMS_Message_to_Client__c}, &#39;&lt;&lt;Lead First Name&gt;&gt;&#39;, {!Get_Intake.litify_pm__Client__r.litify_pm__First_Name__c}), &#39;&lt;&lt;Case Type&gt;&gt;&#39;, {!Get_Intake.Case_Type_Name_del__c}), &#39;&lt;&lt;Caller First Name&gt;&gt;&#39;, {!Get_Intake.Caller__r.litify_pm__First_Name__c}), &#39;&lt;&lt;Client First Name&gt;&gt;&#39;, {!Get_Intake.litify_pm__Client__r.litify_pm__First_Name__c})</expression>
    </formulas>
    <formulas>
        <description>used for automated SMS Task Subject info</description>
        <name>SMS_Task_Subject</name>
        <dataType>String</dataType>
        <expression>&quot;SMS - Sent - &quot; + TEXT(NOW())</expression>
    </formulas>
    <interviewLabel>BRIO | Drip | Comms-Sending Subflow {!$Flow.CurrentDateTime}</interviewLabel>
    <label>BRIO | Drip | Comms-Sending Subflow</label>
    <loops>
        <name>Loop_Outbound_Comm_Records</name>
        <label>Loop Outbound Comm Records</label>
        <locationX>314</locationX>
        <locationY>1574</locationY>
        <collectionReference>var_col_commRecordsToSend</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Is_an_email_being_sent_for_this_Outbound_Comm</targetReference>
        </nextValueConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Copy_2_of_Create_Error_Log</name>
        <label>Create Error Log</label>
        <locationX>1194</locationX>
        <locationY>3386</locationY>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <stringValue>BRIO_Drip_Comms_Sending_Subflow</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Copy_4_of_Create_Error_Log</name>
        <label>Log: Error - Lead Owner Email</label>
        <locationX>3306</locationX>
        <locationY>2546</locationY>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>error</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Copy_5_of_Create_Error_Log</name>
        <label>Create Error Log</label>
        <locationX>4224</locationX>
        <locationY>4694</locationY>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <stringValue>BRIO_Drip_Comms_Sending_Subflow</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Error_Log</name>
        <label>Create Error Log</label>
        <locationX>666</locationX>
        <locationY>3386</locationY>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <stringValue>BRIO_Drip_Comms_Sending_Subflow</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Log4</name>
        <label>Create Log</label>
        <locationX>930</locationX>
        <locationY>2954</locationY>
        <connector>
            <targetReference>Who_is_this_email_from</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <stringValue>BRIO_Drip_Comms_Sending_Subflow</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Yes, we can send</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Log5</name>
        <label>Log: Debug - Email Bounced</label>
        <locationX>1722</locationX>
        <locationY>2954</locationY>
        <connector>
            <targetReference>Is_an_SMS_being_sent_for_this_Outbound_Comm</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Not sending email.  Recipient email bounced</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Log6</name>
        <label>Log: Debug - Contact Opt Out</label>
        <locationX>2250</locationX>
        <locationY>2954</locationY>
        <connector>
            <targetReference>Is_an_SMS_being_sent_for_this_Outbound_Comm</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Not Sending Email, recipient contact has opted out</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Log77</name>
        <label>Create Log</label>
        <locationX>5192</locationX>
        <locationY>4154</locationY>
        <connector>
            <targetReference>Loop_Outbound_Comm_Records</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <stringValue>BRIO_Drip_Comms_Sending_Subflow</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>SMS being sent Default Outcome</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Log88</name>
        <label>Create Log</label>
        <locationX>4488</locationX>
        <locationY>4154</locationY>
        <connector>
            <targetReference>Set_SMS_Template</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <stringValue>BRIO_Drip_Comms_Sending_Subflow</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Yes, send SMS</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <description>Used to create an SMS activity that isn&#39;t currently populating.</description>
        <name>Create_SMS_Activity</name>
        <label>Create SMS Activity</label>
        <locationX>3960</locationX>
        <locationY>4694</locationY>
        <connector>
            <targetReference>Loop_Outbound_Comm_Records</targetReference>
        </connector>
        <inputAssignments>
            <field>Intake__c</field>
            <value>
                <elementReference>Get_Intake.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <stringValue>005Dn0000066Va8</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Priority</field>
            <value>
                <stringValue>Normal</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <elementReference>SMS_Task_Subject</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Type</field>
            <value>
                <stringValue>SMS</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>WhatId</field>
            <value>
                <elementReference>Get_Intake.Id</elementReference>
            </value>
        </inputAssignments>
        <object>Task</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Debug_Intake_Do_Not_Text</name>
        <label>Debug - Intake Do Not Text</label>
        <locationX>4488</locationX>
        <locationY>4586</locationY>
        <connector>
            <targetReference>Loop_Outbound_Comm_Records</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Not Sending SMS, Intake has selected Do Not Text</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Debug_TCPA_Can_t_Text_Now</name>
        <label>Debug - TCPA - Can&#39;t Text Now</label>
        <locationX>4752</locationX>
        <locationY>4586</locationY>
        <connector>
            <targetReference>Loop_Outbound_Comm_Records</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Not Sending SMS, Out of TCPA Time Zone Compliance</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Debug_Contact_is_Null_Not_Sending</name>
        <label>Log: Debug - Contact is Null.  Not Sending</label>
        <locationX>2514</locationX>
        <locationY>2954</locationY>
        <connector>
            <targetReference>Is_an_SMS_being_sent_for_this_Outbound_Comm</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Outbound comm for {!Loop_Outbound_Comm_Records.Recipient__c} but no contact found</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Debug_Email_from_Running_User</name>
        <label>Log: Debug - Email from Running User</label>
        <locationX>930</locationX>
        <locationY>3170</locationY>
        <connector>
            <targetReference>Send_Email_NOT_orgwide_email</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <stringValue>BRIO_Drip_Comms_Sending_Subflow</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Email from running user</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Debug_Filter_Decision_Sending_Disabled</name>
        <label>Log: Debug - Filter Decision - Sending Disabled</label>
        <locationX>578</locationX>
        <locationY>1274</locationY>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Sending Disabled and No Test User when trying to filter</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Debug_Flow_Started</name>
        <label>Log: Debug - Flow Started</label>
        <locationX>314</locationX>
        <locationY>134</locationY>
        <connector>
            <targetReference>Get_Intake</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Flow Started</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Debug_Intake_Do_Not_Email</name>
        <label>Log: Debug - Intake Do Not Email</label>
        <locationX>1986</locationX>
        <locationY>2954</locationY>
        <connector>
            <targetReference>Is_an_SMS_being_sent_for_this_Outbound_Comm</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Not Sending Email, Intake has selected Do Not Email</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Debug_Org_wide_email_send</name>
        <label>Log: Debug - Org wide email send</label>
        <locationX>402</locationX>
        <locationY>3170</locationY>
        <connector>
            <targetReference>Send_Email_to_Contact</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <stringValue>BRIO_Drip_Comms_Sending_Subflow</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Email from orgwide address</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Debug_Recipient_is_Lead_Owner</name>
        <label>Log: Debug - Recipient is Lead Owner</label>
        <locationX>3042</locationX>
        <locationY>2330</locationY>
        <connector>
            <targetReference>Send_Email_to_User_No_OrgWide_Email</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Recipient is Lead Owner and &#39;From&#39; is NOT populated</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Debug_Recipient_is_Vendor</name>
        <label>Log: Debug - Recipient is Vendor</label>
        <locationX>3702</locationX>
        <locationY>2330</locationY>
        <connector>
            <targetReference>Is_Vendor_Comm_Disabled</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Recipient is Vendor: {!Get_Intake.Intake_Vendor__r.Name} ID: {!Get_Intake.Intake_Vendor__c}</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Debug_Sending_Disabled</name>
        <label>Log: Debug - Sending Disabled</label>
        <locationX>534</locationX>
        <locationY>458</locationY>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Sending Disabled. </stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Debug_Testing_User</name>
        <label>Log: Debug - Testing User</label>
        <locationX>270</locationX>
        <locationY>458</locationY>
        <connector>
            <targetReference>Did_we_get_an_input_comm_ID</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Sending Disabled, but Testing User: {!$User.Username} ({!$User.Id})</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Debug_Vendor_Comm_Disabled</name>
        <label>Log: Debug - Vendor Comm Disabled</label>
        <locationX>3570</locationX>
        <locationY>2546</locationY>
        <connector>
            <targetReference>Is_an_SMS_being_sent_for_this_Outbound_Comm</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Vendor Comm Disabled </stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Email_Template_ID_Populated</name>
        <label>Log: Email Template ID Populated</label>
        <locationX>4263</locationX>
        <locationY>1790</locationY>
        <connector>
            <targetReference>Get_Email_Template</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <stringValue>BRIO_Drip_Comms_Sending_Subflow</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Yes, send email</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Error_intake_team_Email</name>
        <label>Log: Error - intake team Email</label>
        <locationX>4626</locationX>
        <locationY>2546</locationY>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>error</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Error sending intake team email: {!$Flow.FaultMessage}</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Error_Path_Not_Handled</name>
        <label>Log: Error - Path Not Handled</label>
        <locationX>2118</locationX>
        <locationY>2546</locationY>
        <connector>
            <targetReference>Can_we_send_to_this_Contact</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>error</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Unhandled Path.  Email Send - Caller Or Client Decision</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Error_Path_Not_Handled1</name>
        <label>Log: Error - Path Not Handled</label>
        <locationX>1458</locationX>
        <locationY>3170</locationY>
        <connector>
            <targetReference>Is_an_SMS_being_sent_for_this_Outbound_Comm</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <stringValue>BRIO_Drip_Comms_Sending_Subflow</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>error</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Unhandled Path: Caller or Client - Who is it from?</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Error_Template_ID_Not_Found</name>
        <label>Log: Error: Template ID Not Found</label>
        <locationX>5154</locationX>
        <locationY>2114</locationY>
        <connector>
            <targetReference>Is_an_SMS_being_sent_for_this_Outbound_Comm</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <stringValue>BRIO_Drip_Comms_Sending_Subflow</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>error</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>No template found, default outcome</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Error_Unhandled_Path_Can_we_send</name>
        <label>Log: Error - Unhandled Path - Can we send</label>
        <locationX>2778</locationX>
        <locationY>2954</locationY>
        <connector>
            <targetReference>Is_an_SMS_being_sent_for_this_Outbound_Comm</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>error</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Unhandled Path. Can we send email to contact</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Error_Vendor_Email</name>
        <label>Log: Error - Vendor Email</label>
        <locationX>4098</locationX>
        <locationY>2654</locationY>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>error</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Error sending vendor email: {!$Flow.FaultMessage}</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_No_Email_Template_Set</name>
        <label>Log: No Email Template Set</label>
        <locationX>5418</locationX>
        <locationY>1790</locationY>
        <connector>
            <targetReference>Is_an_SMS_being_sent_for_this_Outbound_Comm</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <stringValue>BRIO_Drip_Comms_Sending_Subflow</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Template ID Is Null.  No Email Being Sent</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_No_Sending_Path_Configured</name>
        <label>Log: No Sending Path Configured</label>
        <locationX>4890</locationX>
        <locationY>2330</locationY>
        <connector>
            <targetReference>Is_an_SMS_being_sent_for_this_Outbound_Comm</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <stringValue>BRIO_Drip_Comms_Sending_Subflow</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>No Sending Path Configured</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Recipient_is_Client_or_Caller</name>
        <label>Log: Recipient is Client or Caller</label>
        <locationX>1854</locationX>
        <locationY>2330</locationY>
        <connector>
            <targetReference>Decision_Client_or_Caller_Recipient</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Recipient is  {!Loop_Outbound_Comm_Records.Recipient__c}</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Recipient_is_Intake_Team</name>
        <label>Log: Recipient is Intake Team</label>
        <locationX>4362</locationX>
        <locationY>2330</locationY>
        <connector>
            <targetReference>Send_Intake_Team_Email</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <elementReference>const_FlowName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Recipient is Intake Team</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Template_Confirmed</name>
        <label>Log: Template Confirmed</label>
        <locationX>3372</locationX>
        <locationY>2114</locationY>
        <connector>
            <targetReference>Sending_Specs</targetReference>
        </connector>
        <inputAssignments>
            <field>Flow_Name__c</field>
            <value>
                <stringValue>BRIO_Drip_Comms_Sending_Subflow</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Log_Type__c</field>
            <value>
                <stringValue>debug</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Message__c</field>
            <value>
                <stringValue>Email template found: {!Get_Email_Template.Name}({!Get_Email_Template.Id})</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Record_Id__c</field>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </inputAssignments>
        <object>BRIO_Log_Platform_Event__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>Get_Caller_Contact</name>
        <label>Get Caller Contact</label>
        <locationX>1854</locationX>
        <locationY>2546</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_Caller_to_Contac_Var</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Intake.Caller__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>AccountId</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Client_Contact</name>
        <label>Get Client Contact</label>
        <locationX>1590</locationX>
        <locationY>2546</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_GET_Contact_to_variable0</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Intake.litify_pm__Client__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>AccountId</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Email_Template</name>
        <label>Get Email Template</label>
        <locationX>4263</locationX>
        <locationY>1898</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Template_found</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Loop_Outbound_Comm_Records.Email_Template_ID__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>EmailTemplate</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Intake</name>
        <label>Get Intake</label>
        <locationX>314</locationX>
        <locationY>242</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Sending_Enabled_or_Test_User</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>input_IntakeID</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>litify_pm__Intake__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Outbound_Communication_record</name>
        <label>Get Outbound Communication record</label>
        <locationX>182</locationX>
        <locationY>866</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Add_Single_Record_to_Collection</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>input_OutboundCommsID</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Outbound_Communications__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <start>
        <locationX>188</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Log_Debug_Flow_Started</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <name>Check_Phone_Time_Zone</name>
        <label>Check Phone Time Zone</label>
        <locationX>4488</locationX>
        <locationY>4370</locationY>
        <connector>
            <targetReference>Check_if_we_can_send_SMS</targetReference>
        </connector>
        <flowName>BRIO_Phone_Time_Zone_Subflow</flowName>
        <inputAssignments>
            <name>Phone</name>
            <value>
                <elementReference>Get_Intake.Mobile_twilio__c</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <variables>
        <name>currentItem_Copy_1_of_Collection_Filter_1</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Outbound_Communications__c</objectType>
    </variables>
    <variables>
        <name>currentItem_Filter_OC_Collection_Active_or_Active_for_Testing</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Outbound_Communications__c</objectType>
    </variables>
    <variables>
        <description>Collection of outbound comm records to process for this intake.  If this value is present, then the intakeID field is ignored.</description>
        <name>input_col_CommRecords</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Outbound_Communications__c</objectType>
    </variables>
    <variables>
        <name>input_IntakeID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>Use if you want to send a single outbound comm record.  Otherwise use the collection.  If collection is present this field is ignored</description>
        <name>input_OutboundCommsID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>var_col_commRecordsToSend</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Outbound_Communications__c</objectType>
    </variables>
    <variables>
        <name>var_rec_outboundComms</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Outbound_Communications__c</objectType>
    </variables>
    <variables>
        <name>var_rec_RecipientContact</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contact</objectType>
    </variables>
    <variables>
        <name>var_SMS</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
