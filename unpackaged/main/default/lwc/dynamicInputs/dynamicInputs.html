<!--
  @description       : 
  @author            : Jacob Barnett
  @group             : 
  @last modified on  : 05-09-2025
  @last modified by  : Jacob Barnett
-->
<template>
    <ul class="slds-card slds-card_boundary">
        <li class="slds-item">
            <lightning-layout class="slds-p-around_medium slds-border_bottom" horizontal-align="spread" vertical-align="center">
                <lightning-layout-item flexibility="auto">
                    <template if:true={label}>
                        <label class="slds-form-element__label slds-grid slds-grid_vertical-align-center">
                            <span>{label}</span>
                            <template if:true={helpText}>
                                <lightning-helptext class="slds-m-left_x-small" content={helpText}></lightning-helptext>
                            </template>
                        </label>
                        <template if:true={required}>
                            <div class="required-text">(required)</div>
                        </template>
                    </template>                        

                    <template if:true={answerType}>
                        <!-- Text Input -->
                        <template if:true={isString}>
                            <lightning-input type="text" value={answer} placeholder="Enter your answer here..." onchange={handleChange}></lightning-input>
                        </template>

                        <!-- Text Area -->
                        <template if:true={isTextArea}>
                            <lightning-textarea value={answer} onchange={handleChange}></lightning-textarea>
                        </template>

                        <!-- Picklist -->
                        <template if:true={isPicklist}>
                            <lightning-combobox value={answer} options={picklistOptions} onchange={handleChange}></lightning-combobox>
                        </template>

                        <!-- Multi-Select Picklist -->
                        <template if:true={isMultiSelectPicklist}>
                            <lightning-dual-listbox value={answer} options={picklistOptions} onchange={handleChange}></lightning-dual-listbox>
                        </template>

                        <!-- Checkbox -->
                        <template if:true={isCheckbox}>
                            <lightning-input type="checkbox" checked={BooleanValue} onchange={handleChange}></lightning-input>
                        </template>

                        <!-- Date -->
                        <template if:true={isDate}>
                            <lightning-input type="date" value={answer} onchange={handleChange}></lightning-input>
                        </template>

                        <!-- Integer -->
                        <template if:true={isInteger}>
                            <lightning-input type="number" value={answer} onchange={handleChange}></lightning-input>
                        </template>

                        <!-- DateTime -->
                        <template if:true={isDateTime}>
                            <lightning-input type="datetime-local" value={answer} onchange={handleChange}></lightning-input>
                        </template>

                        <!-- Decimal -->
                        <template if:true={isDecimal}>
                            <lightning-input type="number" value={answer} step="0.01" onchange={handleChange}></lightning-input>
                        </template>

                        <!-- Email -->
                        <template if:true={isEmail}>
                            <lightning-input type="email" value={answer} onchange={handleChange}></lightning-input>
                        </template>

                        <!-- Percent -->
                        <template if:true={isPercent}>
                            <lightning-input type="number" value={answer} step="0.01" formatter="percent" onchange={handleChange}></lightning-input>
                        </template>

                        <!-- URL -->
                        <template if:true={isURL}>
                            <lightning-input type="url" value={answer} onchange={handleChange}></lightning-input>
                        </template>

                        <!-- Currency -->
                        <template if:true={isCurrency}>
                            <lightning-input type="number" value={answer} formatter="currency" onchange={handleChange}></lightning-input>
                        </template>

                        <!-- Phone -->
                        <template if:true={isPhone}>
                            <lightning-input 
                                type="tel" 
                                value={answer} 
                                placeholder="(123) 456-7890 or 123-456-7890" 
                                onchange={handleChange} 
                                pattern="^(\([0-9]{3}\) |[0-9]{3}-)[0-9]{3}-[0-9]{4}$" 
                                message-when-pattern-mismatch="Phone number must be in the format (123) 456-7890 or 123-456-7890">
                            </lightning-input>
                        </template>

                        <!-- Address -->
                        <template if:true={isAddress}>
                            <lightning-input-address
                                address-label="Address"
                                street-label="Street"
                                city-label="City"
                                country-label="Country"
                                province-label="Province"
                                postal-code-label="PostalCode"
                                street=""
                                city=""
                                country=""
                                province=""
                                postal-code=""
                                required
                                field-level-help="Help Text for inputAddress field"
                                onchange={handleChange}>
                            </lightning-input-address>
                        </template>

                        <!-- Encrypted -->
                        <template if:true={isEncrypted}>
                            <lightning-input 
                                type="password" 
                                value={answer} 
                                placeholder="Enter SSN (e.g., 123-45-6789)"
                                onchange={handleChange}>
                            </lightning-input>
                        </template>

                        <!-- Lookup -->
                        <template if:true={isLookup}>
                            <div class="slds-form-element slds-m-top_small">
                                <template if:true={hasSelectedRecord}>
                                    <div class="slds-form-element__control">
                                        <lightning-input
                                            type="text"
                                            readonly
                                            value={selectedRecordLabel}
                                            variant="label-hidden">
                                        </lightning-input>
                                    </div>
                                </template>
                                <template if:false={hasSelectedRecord}>
                                    <div class="slds-text-body_regular">No record selected</div>
                                </template>
                            </div>
                        </template>                        

                        <!-- Multi-Lookup -->
                        <template if:true={isMultiLookup}>
                            <template if:true={selectedRecords.length}>
                                <lightning-pill-container items={selectedRecords}></lightning-pill-container>
                            </template>
                            <template if:false={selectedRecords.length}>
                                <div class="slds-text-body_regular slds-m-top_small">No Records</div>
                            </template>
                        </template>
                    </template>
                </lightning-layout-item>

            <!-- Flow modal button -->
                <template if:true={buttonLabel}>
                    <lightning-layout-item>
                        <lightning-button label={buttonLabel} onclick={handleButtonClick}></lightning-button>
                    </lightning-layout-item>
                </template>
            </lightning-layout>
        </li>
    </ul>

    <!-- Flow Modal -->
    <template if:true={showFlow}>
        <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container custom-modal-large">
                <header class="slds-modal__header">
                    <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={closeModal}>
                        <lightning-icon icon-name="utility:close" alternative-text="Close" size="small"></lightning-icon>
                    </button>
                    <h2 class="slds-text-heading_medium"></h2>
                </header>
                <div class="slds-modal__content slds-p-around_medium">
                    <lightning-flow
                        flow-api-name={flowApiName}
                        onstatuschange={handleFlowStatusChange}
                        flow-input-variables={flowInputVariables}>
                    </lightning-flow>
                </div>
                <footer class="slds-modal__footer"></footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>
</template>